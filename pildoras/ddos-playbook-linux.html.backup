<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playbook de Mitigaci√≥n DDoS</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 2em;
            color: #333;
        }
        h1, h2 {
            color: #2c3e50;
        }
        h1 {
            border-bottom: 2px solid #3498db;
            padding-bottom: 0.5em;
        }
        h2 {
            margin-top: 1.5em;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #f9f9f9;
            padding: 2em;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        code, pre {
            background-color: #ecf0f1;
            padding: 2px 6px;
            border-radius: 4px;
            color: #c0392b;
            font-family: "Courier New", Courier, monospace;
        }
        pre {
            padding: 1em;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        ul {
            list-style-type: disc;
            padding-left: 20px;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üõ°Ô∏è Playbook de Mitigaci√≥n DDoS</h1>

    <div class="card">
        <div class="card-body">
            <p><strong>Servidor Objetivo:</strong> <code>10.0.0.11</code></p>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h2>1. Detecci√≥n y An√°lisis Inicial</h2>
            <h3>Indicadores de Ataque DDoS</h3>
            <ul class="ps-4">
                <li class="mb-2">Alto uso de ancho de banda</li>
                <li class="mb-2">Degradaci√≥n del rendimiento del servidor</li>
                <li class="mb-2">Timeouts de conexi√≥n</li>
                <li class="mb-2">Logs con patrones de tr√°fico an√≥malo</li>
                <li class="mb-2">Aumento inusual de conexiones simult√°neas</li>
            </ul>
            <h3>Comandos de Diagn√≥stico</h3>
            <pre><code># Verificar conexiones activas
netstat -an | grep :80 | wc -l

# Monitorear tr√°fico de red
iftop -i eth0

# Verificar uso de CPU y memoria
top
htop

# Revisar logs del sistema
tail -f /var/log/apache2/access.log
tail -f /var/log/nginx/access.log</code></pre>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h2>2. Contenci√≥n Inmediata</h2>
            <h3>A. Rate Limiting</h3>
            <pre><code># Configurar iptables para limitar conexiones por IP
iptables -A INPUT -p tcp --dport 80 -m connlimit --connlimit-above 20 -j DROP
iptables -A INPUT -p tcp --dport 443 -m connlimit --connlimit-above 20 -j DROP

# Limitar nuevas conexiones por segundo
iptables -A INPUT -p tcp --dport 80 -m recent --set --name HTTP
iptables -A INPUT -p tcp --dport 80 -m recent --update --seconds 10 --hitcount 20 --name HTTP -j DROP</code></pre>
            <h3>B. Bloqueo de IPs Espec√≠ficas</h3>
            <pre><code># Identificar IPs atacantes desde logs
awk '{print $1}' /var/log/apache2/access.log | sort | uniq -c | sort -nr | head -20

# Bloquear IPs espec√≠ficas
iptables -A INPUT -s [IP_ATACANTE] -j DROP

# Bloquear rangos de IP si es necesario
iptables -A INPUT -s 192.168.1.0/24 -j DROP</code></pre>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h2>3. Configuraci√≥n del Servidor Web</h2>
            <h3>Apache</h3>
            <pre><code># En /etc/apache2/apache2.conf
Timeout 30
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5

# Limitar tama√±o de request
LimitRequestBody 10485760
LimitRequestFields 100
LimitRequestFieldSize 1024
LimitRequestLine 4094</code></pre>
            <h3>Nginx</h3>
            <pre><code># En /etc/nginx/nginx.conf
http {
    limit_req_zone $binary_remote_addr zone=one:10m rate=1r/s;
    limit_conn_zone $binary_remote_addr zone=addr:10m;

    server {
        limit_req zone=one burst=5;
        limit_conn addr 10;

        client_body_timeout 12;
        client_header_timeout 12;
        send_timeout 10;
        client_max_body_size 10M;
    }
}</code></pre>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h2>4. Monitoreo Continuo</h2>
            <h3>Scripts de Monitoreo</h3>
            <pre><code>#!/bin/bash
# monitor_connections.sh
while true; do
    echo "$(date): Conexiones activas: $(netstat -an | grep :80 | wc -l)"
    echo "$(date): Load average: $(uptime | awk -F'load average:' '{print $2}')"
    sleep 30
done</code></pre>
            <h3>Alertas Autom√°ticas</h3>
            <pre><code># Crear alerta si conexiones superan umbral
if [ $(netstat -an | grep :80 | wc -l) -gt 1000 ]; then
    echo "ALERTA DDoS: M√°s de 1000 conexiones activas" | mail -s "DDoS Alert" admin@empresa.com
fi</code></pre>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h2>5. Escalamiento y Recursos Adicionales</h2>
            <h3>CDN y Proxy Reverso</h3>
            <ul class="ps-4">
                <li class="mb-2">Configurar Cloudflare, AWS CloudFront o similar</li>
                <li class="mb-2">Implementar proxy reverso con Nginx</li>
                <li class="mb-2">Activar protecci√≥n DDoS en el proveedor de CDN</li>
            </ul>
            <h3>Contactos de Emergencia</h3>
            <ul class="ps-4">
                <li class="mb-2"><strong>ISP/Proveedor de Hosting:</strong> [N√∫mero de contacto]</li>
                <li class="mb-2"><strong>Equipo de Seguridad:</strong> [Contacto interno]</li>
                <li class="mb-2"><strong>Proveedor CDN:</strong> [Soporte t√©cnico]</li>
            </ul>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h2>6. Post-Incidente</h2>
            <h3>An√°lisis Forense</h3>
            <pre><code># Guardar logs para an√°lisis
cp /var/log/apache2/access.log /backup/ddos_incident_$(date +%Y%m%d).log
cp /var/log/syslog /backup/system_ddos_$(date +%Y%m%d).log</code></pre>
            <h3>Documentaci√≥n</h3>
            <ul class="ps-4">
                <li class="mb-2">Hora de inicio y fin del ataque</li>
                <li class="mb-2">IPs de origen identificadas</li>
                <li class="mb-2">Tipo de ataque (volum√©trico, de protocolo, de aplicaci√≥n)</li>
                <li class="mb-2">Medidas tomadas y su efectividad</li>
                <li class="mb-2">Impacto en servicios</li>
                <li class="mb-2">Lecciones aprendidas</li>
            </ul>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h2>7. Prevenci√≥n Futura</h2>
            <h3>Hardening del Servidor</h3>
            <ul class="ps-4">
                <li class="mb-2">Actualizar sistema operativo y aplicaciones</li>
                <li class="mb-2">Configurar firewall robusto</li>
                <li class="mb-2">Implementar fail2ban</li>
                <li class="mb-2">Configurar backup autom√°tico</li>
            </ul>
            <h3>Monitoreo Proactivo</h3>
            <ul class="ps-4">
                <li class="mb-2">Configurar alertas de tr√°fico an√≥malo</li>
                <li class="mb-2">Implementar herramientas como Nagios o Zabbix</li>
                <li class="mb-2">Establecer baselines de tr√°fico normal</li>
            </ul>
            <p>Este playbook debe adaptarse seg√∫n la infraestructura espec√≠fica y mantenerse actualizado con las mejores pr√°cticas de seguridad.</p>
        </div>
    </div>

    <footer style="text-align: center; margin-top: 2em; padding-top: 1em; border-top: 1px solid #ccc;">
        <p><a href="./pildoras.html">Volver a la p√°gina principal de p√≠ldoras</a></p>
    </footer>
</body>
</html>
