<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Playbook de Mitigaci√≥n DDoS</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #e74c3c;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        
        h2 {
            color: #e74c3c;
            border-left: 4px solid #3498db;
            padding-left: 15px;
            margin-top: 30px;
        }
        
        h3 {
            color: #34495e;
            margin-top: 25px;
        }
        
        .server-info {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 30px;
            border: 2px solid #3498db;
        }
        
        .indicators {
            background: #d5f4e6;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .indicators ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .indicators li {
            margin: 5px 0;
        }
        
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
        }
        
        code {
            background: #ecf0f1;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #e74c3c;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #f39c12;
        }
        
        .alert {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #e74c3c;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #27ae60;
        }
        
        .checklist {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .checklist ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .contacts {
            background: #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #bdc3c7;
            color: #7f8c8d;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 20px;
            }
            
            pre {
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ°Ô∏è Playbook de Mitigaci√≥n DDoS</h1>
        
        <div class="server-info">
            <strong>üéØ Servidor Objetivo:</strong> <code>10.0.0.11</code>
        </div>

        <h2>1. Detecci√≥n y An√°lisis Inicial</h2>
        
        <h3>Indicadores de Ataque DDoS</h3>
        <div class="indicators">
            <ul>
                <li>‚úÖ Alto uso de ancho de banda</li>
                <li>‚úÖ Degradaci√≥n del rendimiento del servidor</li>
                <li>‚úÖ Timeouts de conexi√≥n</li>
                <li>‚úÖ Logs con patrones de tr√°fico an√≥malo</li>
                <li>‚úÖ Aumento inusual de conexiones simult√°neas</li>
            </ul>
        </div>

        <h3>Comandos de Diagn√≥stico</h3>
        <pre><code># Verificar conexiones activas
netstat -an | grep :80 | wc -l

# Monitorear tr√°fico de red
iftop -i eth0

# Verificar uso de CPU y memoria
top
htop

# Revisar logs del sistema
tail -f /var/log/apache2/access.log
tail -f /var/log/nginx/access.log</code></pre>

        <h2>2. Contenci√≥n Inmediata</h2>

        <h3>A. Rate Limiting</h3>
        <pre><code># Configurar iptables para limitar conexiones por IP
iptables -A INPUT -p tcp --dport 80 -m connlimit --connlimit-above 20 -j DROP
iptables -A INPUT -p tcp --dport 443 -m connlimit --connlimit-above 20 -j DROP

# Limitar nuevas conexiones por segundo
iptables -A INPUT -p tcp --dport 80 -m recent --set --name HTTP
iptables -A INPUT -p tcp --dport 80 -m recent --update --seconds 10 --hitcount 20 --name HTTP -j DROP</code></pre>

        <h3>B. Bloqueo de IPs Espec√≠ficas</h3>
        <pre><code># Identificar IPs atacantes desde logs
awk '{print $1}' /var/log/apache2/access.log | sort | uniq -c | sort -nr | head -20

# Bloquear IPs espec√≠ficas
iptables -A INPUT -s [IP_ATACANTE] -j DROP

# Bloquear rangos de IP si es necesario
iptables -A INPUT -s 192.168.1.0/24 -j DROP</code></pre>

        <h2>3. Configuraci√≥n del Servidor Web</h2>

        <h3>Apache</h3>
        <pre><code># En /etc/apache2/apache2.conf
Timeout 30
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5

# Limitar tama√±o de request
LimitRequestBody 10485760
LimitRequestFields 100
LimitRequestFieldSize 1024
LimitRequestLine 4094</code></pre>

        <h3>Nginx</h3>
        <pre><code># En /etc/nginx/nginx.conf
http {
    limit_req_zone $binary_remote_addr zone=one:10m rate=1r/s;
    limit_conn_zone $binary_remote_addr zone=addr:10m;
    
    server {
        limit_req zone=one burst=5;
        limit_conn addr 10;
        
        client_body_timeout 12;
        client_header_timeout 12;
        send_timeout 10;
        client_max_body_size 10M;
    }
}</code></pre>

        <h2>4. Monitoreo Continuo</h2>

        <h3>Scripts de Monitoreo</h3>
        <pre><code>#!/bin/bash
# monitor_connections.sh
while true; do
    echo "$(date): Conexiones activas: $(netstat -an | grep :80 | wc -l)"
    echo "$(date): Load average: $(uptime | awk -F'load average:' '{print $2}')"
    sleep 30
done</code></pre>

        <h3>Alertas Autom√°ticas</h3>
        <pre><code># Crear alerta si conexiones superan umbral
if [ $(netstat -an | grep :80 | wc -l) -gt 1000 ]; then
    echo "ALERTA DDoS: M√°s de 1000 conexiones activas" | mail -s "DDoS Alert" admin@empresa.com
fi</code></pre>

        <h2>5. Escalamiento y Recursos Adicionales</h2>

        <h3>CDN y Proxy Reverso</h3>
        <div class="success">
            <ul>
                <li>Configurar Cloudflare, AWS CloudFront o similar</li>
                <li>Implementar proxy reverso con Nginx</li>
                <li>Activar protecci√≥n DDoS en el proveedor de CDN</li>
            </ul>
        </div>

        <h3>Contactos de Emergencia</h3>
        <div class="contacts">
            <ul>
                <li><strong>ISP/Proveedor de Hosting:</strong> [N√∫mero de contacto]</li>
                <li><strong>Equipo de Seguridad:</strong> [Contacto interno]</li>
                <li><strong>Proveedor CDN:</strong> [Soporte t√©cnico]</li>
            </ul>
        </div>

        <h2>6. Post-Incidente</h2>

        <h3>An√°lisis Forense</h3>
        <pre><code># Guardar logs para an√°lisis
cp /var/log/apache2/access.log /backup/ddos_incident_$(date +%Y%m%d).log
cp /var/log/syslog /backup/system_ddos_$(date +%Y%m%d).log</code></pre>

        <h3>Documentaci√≥n</h3>
        <div class="checklist">
            <ul>
                <li>‚òê Hora de inicio y fin del ataque</li>
                <li>‚òê IPs de origen identificadas</li>
                <li>‚òê Tipo de ataque (volum√©trico, de protocolo, de aplicaci√≥n)</li>
                <li>‚òê Medidas tomadas y su efectividad</li>
                <li>‚òê Impacto en servicios</li>
                <li>‚òê Lecciones aprendidas</li>
            </ul>
        </div>

        <h2>7. Prevenci√≥n Futura</h2>

        <h3>Hardening del Servidor</h3>
        <div class="warning">
            <ul>
                <li>Actualizar sistema operativo y aplicaciones</li>
                <li>Configurar firewall robusto</li>
                <li>Implementar fail2ban</li>
                <li>Configurar backup autom√°tico</li>
            </ul>
        </div>

        <h3>Monitoreo Proactivo</h3>
        <div class="success">
            <ul>
                <li>Configurar alertas de tr√°fico an√≥malo</li>
                <li>Implementar herramientas como Nagios o Zabbix</li>
                <li>Establecer baselines de tr√°fico normal</li>
            </ul>
        </div>

        <div class="footer">
            <div class="alert">
                <strong>üìù Nota:</strong> Este playbook debe adaptarse seg√∫n la infraestructura espec√≠fica y mantenerse actualizado con las mejores pr√°cticas de seguridad.
            </div>
            <p>Generado el: <strong><span id="fecha"></span></strong></p>
            <p style="text-align: center; margin-top: 20px;"><a href="../pildoras/pildoras.html" class="btn btn-primary">Volver a todas las p√≠ldoras</a></p>
        </div>
    </div>

    <script>
        // Mostrar fecha actual
        document.getElementById('fecha').textContent = new Date().toLocaleDateString('es-ES', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
        
        // Hacer que los checkboxes sean interactivos
        document.querySelectorAll('.checklist li').forEach(item => {
            item.style.cursor = 'pointer';
            item.addEventListener('click', function() {
                if (this.textContent.includes('‚òê')) {
                    this.innerHTML = this.innerHTML.replace('‚òê', '‚úÖ');
                    this.style.textDecoration = 'line-through';
                    this.style.opacity = '0.7';
                } else {
                    this.innerHTML = this.innerHTML.replace('‚úÖ', '‚òê');
                    this.style.textDecoration = 'none';
                    this.style.opacity = '1';
                }
            });
        });
    </script>
</body>
</html>
